<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å…¥ - å­¸ç”Ÿç¶œåˆç´€éŒ„æš¨èª²è¡¨ç³»çµ±</title>

	<style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Microsoft JhengHei", "PingFang TC", "Noto Sans TC", sans-serif; background-color: #f5f5f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    button, input, select, textarea {
        font-family: inherit;
    }
    .container { background-color: white; padding: 40px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; width: 90%; max-width: 450px; }
    h1 { color: #333; margin-top: 0; margin-bottom: 25px; }
    input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; font-size: 1em; }
    button { width: 100%; padding: 12px; background-color: #4a90e2; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 1em; }
    button:hover { background-color: #357abd; }
    #error-message { color: #d0021b; margin-top: 10px; min-height: 20px; font-size: 0.9em; }
    #splash-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #f5f5f5; z-index: 9999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
    .spinner { border: 4px solid rgba(0, 0, 0, 0.1); width: 36px; height: 36px; border-radius: 50%; border-left-color: #4a90e2; animation: spin 1s ease infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .password-wrapper { position: relative; display: flex; align-items: center; }
    .password-wrapper input { padding-right: 50px; }
    .toggle-password { position: absolute; right: 15px; cursor: pointer; font-size: 1.2em; color: #888; }
    
    #google-signin-btn { background-color: #ffffff; color: #444; border: 1px solid #ccc; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1.1em; padding: 15px; }
    #google-signin-btn:hover { background-color: #f8f8f8; }
    #google-signin-btn img { width: 22px; height: 22px; }

    .admin-toggle-link { display: block; margin-top: 25px; font-size: 0.9em; color: #6c757d; text-decoration: none; cursor: pointer; }
    .admin-toggle-link:hover { text-decoration: underline; }

    .options-container { display: flex; justify-content: center; align-items: center; margin: 15px 0; font-size: 0.9em; color: #555; }
    #remember-me { margin-right: 8px; width: 16px; height: 16px; }
    
    /* Onboarding Modal Styles */
    .onboarding-modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); justify-content: center; align-items: center; padding: 15px; box-sizing: border-box; }
    .onboarding-modal .container { text-align: left; }
    .onboarding-modal h2 { text-align: center; margin-bottom: 20px; }
    .selection-list { list-style-type: none; padding: 0; margin: 20px 0; max-height: 40vh; overflow-y: auto; border: 1px solid #eee; border-radius: 5px; }
    .selection-list li { padding: 15px; border-bottom: 1px solid #eee; cursor: pointer; transition: background-color 0.2s; }
    .selection-list li:last-child { border-bottom: none; }
    .selection-list li:hover { background-color: #f5f5f5; }
    .selection-list strong { display: block; font-size: 1.1em; color: #333; }
    .selection-list span { font-size: 0.9em; color: #666; }

    /* <<< START OF MODIFICATION: æ‰‹æ©Ÿç‰ˆé¢å¤§ç½é›£ä¿®å¾© V3 >>> */

    /* 1. ä¿®æ­£ body æ¨£å¼ï¼šç¢ºä¿ä¸å‡ºç¾æ°´å¹³æ»¾å‹•æ¢ï¼Œä¸¦ä½”æ»¿è¦–å£é«˜åº¦ */
    body { 
        /* ä¿®æ”¹ï¼šç¢ºä¿ä½”æ»¿è¦–å£é«˜åº¦ä¸¦è™•ç†å‚ç›´æ»¾å‹• */
        height: 100vh;
        /* æ–°å¢ */
        min-height: 100vh; 
        /* æ–°å¢ çµæŸ */
        margin: 0; 

        /* æ–°å¢ï¼šç¢ºä¿å¯¬åº¦ä¸æœƒå› ç‚ºå…§å®¹æº¢å‡ºè€Œæ’å¤§ */
        width: 100%;
        overflow-x: hidden;
        /* æ–°å¢ çµæŸ */
    }

    /* 2. ä¿®æ­£ .container æ¨£å¼ï¼šè§£æ±ºå¤ªå¯¬ã€é é‚ŠåŠå¤šé¤˜æ²è»¸å•é¡Œ */
    .container { 
        background-color: white; 
        /* ä¿®æ”¹ï¼šèª¿æ•´ paddingï¼Œåœ¨æ‰‹æ©Ÿä¸Šçµ¦å…§å®¹ç•™å‡ºè¶³å¤ çš„å·¦å³ç©ºé–“ */
        padding: 30px 20px; 
        /* ä¿®æ”¹ çµæŸ */
        border-radius: 8px; 
        box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
        text-align: center; 
        
        /* ä¿æŒå¯¬åº¦ 90%ï¼Œä½†é™åˆ¶æœ€å¤§ 450px */
        width: 90%; 
        max-width: 450px; 
        
        /* ç§»é™¤åŸæœ‰çš„ overflow-y ç›¸é—œè¨­ç½®ï¼Œé˜²æ­¢ä¸å¿…è¦çš„æ²è»¸ */
        /* æ–°å¢ï¼šè™•ç†å‚ç›´ç©ºé–“ä¸è¶³æ™‚çš„æ»¾å‹•ï¼ˆå¦‚æœå…§å®¹çœŸçš„è¶…å‡ºäº†ï¼‰ */
        overflow-y: auto;
        max-height: 95vh;
        /* æ–°å¢ çµæŸ */
        
        /* æ–°å¢ï¼šåœ¨ mobile è¦–åœ–ä¸‹å¢åŠ å®¹å™¨èˆ‡è¦–å£é‚Šç·£çš„é–“è·ï¼ˆè®“ç™½è‰²æ¡†ç¸®é€²ï¼‰ */
        margin: 10px auto; 
        /* æ–°å¢ çµæŸ */
    }
    
    /* 3. ä¿®æ­£ h1 æ¨£å¼ï¼šé˜²æ­¢é•·æ¨™é¡Œæ’ç ´å®¹å™¨ */
    h1 { 
        color: #333; 
        margin-top: 0; 
        margin-bottom: 25px; 
        /* æ–°å¢ï¼šå…è¨±é•·æ¨™é¡Œåœ¨å®¹å™¨å…§æ›è¡Œï¼Œé˜²æ­¢æº¢å‡º */
        word-break: break-word; 
        /* æ–°å¢ çµæŸ */
    }

    /* 4. ä¿®æ­£è¼¸å…¥æ¡†/æŒ‰éˆ•é«˜åº¦å’Œ Google æŒ‰éˆ•æ’ç‰ˆå•é¡Œ */
    input { 
        width: 100%; 
        /* ä¿®æ”¹ï¼šç¢ºä¿è¼¸å…¥æ¡†æœ‰è¶³å¤ çš„é«˜åº¦ */
        padding: 12px; 
        height: 48px; /* æ–°å¢ï¼šå›ºå®šè¼¸å…¥æ¡†é«˜åº¦ */
        margin: 10px 0; 
        border: 1px solid #ccc; 
        border-radius: 4px; 
        box-sizing: border-box; 
        font-size: 1em; 
    }
    
    #google-signin-btn { 
        background-color: #ffffff; 
        color: #444; 
        border: 1px solid #ccc; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        gap: 10px; 
        font-size: 1.1em; 
        padding: 15px; 
        height: 54px; /* æ–°å¢ï¼šçµ¦æŒ‰éˆ•ä¸€å€‹å›ºå®šçš„é«˜åº¦ */

        /* æ–°å¢ï¼šç¢ºä¿æ–‡å­—å’Œåœ–æ¨™ä¸è¢«æ“ å£“ï¼Œä¸¦åœ¨å°è¢å¹•ä¸Šå®Œæ•´é¡¯ç¤º */
        white-space: nowrap; 
        min-width: 100%;
        box-sizing: border-box;
    }

    /* <<< END OF MODIFICATION: æ‰‹æ©Ÿç‰ˆé¢å¤§ç½é›£ä¿®å¾© V3 >>> */
	</style>
</head>
<body>
    <div id="splash-screen"><div class="spinner"></div><p style="margin-top: 20px; color: #555;">è¼‰å…¥ä¸­...</p></div>
    
    <div id="login-view">
        <div class="container">
            <h1>å­¸ç”Ÿç¶œåˆç´€éŒ„æš¨èª²è¡¨ç³»çµ±</h1>
            
            <div id="teacher-login-view">
                <button id="google-signin-btn">
                    <img src="https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png" alt="Google Logo">
                    ä½¿ç”¨ Google å¸³è™Ÿç™»å…¥ (æ•™å¸«)
                </button>
                <a href="#" id="show-admin-login" class="admin-toggle-link">ç®¡ç†å“¡ç™»å…¥è«‹é»æ­¤</a>
            </div>

            <div id="admin-login-view" style="display: none;">
                <form id="login-form">
                    <input type="email" id="login-email" placeholder="ç®¡ç†å“¡ Email" required autocomplete="email">
                    <div class="password-wrapper">
                        <input type="password" id="login-password" placeholder="å¯†ç¢¼" required autocomplete="current-password">
                        <span class="toggle-password" data-target="login-password">ğŸ‘ï¸</span>
                    </div>
                    <div class="options-container"><input type="checkbox" id="remember-me"><label for="remember-me">ä¿æŒç™»å…¥ç‹€æ…‹</label></div>
                    <button type="submit">ç®¡ç†å“¡ç™»å…¥</button>
                </form>
                <a href="#" id="back-to-teacher-login" class="admin-toggle-link">è¿”å›æ•™å¸«ç™»å…¥</a>
            </div>
            
            <p id="error-message"></p>
        </div>
    </div>

    <div id="school-selection-view" class="onboarding-modal">
        <div class="container">
            <h2>èº«åˆ†é©—è­‰</h2>
            <p>æˆ‘å€‘åœ¨æ‚¨çš„ Email ç¶²åŸŸä¸­æ‰¾åˆ°äº†ä»¥ä¸‹å­¸æ ¡ï¼Œè«‹é¸æ“‡æ‚¨ä»»è·çš„å­¸æ ¡ï¼š</p>
            <ul id="school-selection-list" class="selection-list">
                </ul>
        </div>
    </div>

    <div id="teacher-selection-view" class="onboarding-modal">
        <div class="container">
            <h2 id="teacher-selection-title">èº«åˆ†ç¢ºèª</h2>
            <p>è«‹åœ¨ä¸‹åˆ—åå–®ä¸­é¸æ“‡æ‚¨çš„èº«åˆ†ï¼Œä»¥å®Œæˆå¸³è™Ÿç¶å®šã€‚</p>
            <ul id="teacher-selection-list" class="selection-list">
                </ul>
        </div>
    </div>


    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
	  const firebaseConfig = {
		apiKey: "AIzaSyAVLFoqQlSR5NK_ZaWgL07eA2LMsfHT_Ew",
		authDomain: "classrecords-13902.firebaseapp.com",
		projectId: "classrecords-13902",
		storageBucket: "classrecords-13902.firebasestorage.app",
		messagingSenderId: "431747377367",
		appId: "1:431747377367:web:b157a8f5c59ce38091e892",
		measurementId: "G-JWTQGM9XMP"
	  };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        // --- DOM å…ƒç´  ---
        const splashScreen = document.getElementById('splash-screen');
        const loginView = document.getElementById('login-view');
        const errorMessage = document.getElementById('error-message');
        const schoolSelectionView = document.getElementById('school-selection-view');
        const teacherSelectionView = document.getElementById('teacher-selection-view');
        // ... å…¶ä»– DOM å…ƒç´  ...
        const teacherLoginView = document.getElementById('teacher-login-view');
        const adminLoginView = document.getElementById('admin-login-view');
        const showAdminLoginLink = document.getElementById('show-admin-login');
        const backToTeacherLoginLink = document.getElementById('back-to-teacher-login');
        const googleSignInBtn = document.getElementById('google-signin-btn');
        const loginForm = document.getElementById('login-form');
        const loginEmailInput = document.getElementById('login-email');


        const savedEmail = localStorage.getItem('lastLoginEmail');
        if (savedEmail) {
            loginEmailInput.value = savedEmail;
        }
        
        // --- æ ¸å¿ƒèªè­‰é‚è¼¯ ---
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                if (user.email) {
                    localStorage.setItem('lastLoginEmail', user.email);
                }
                
                splashScreen.style.display = 'flex';
                const userDoc = await db.collection('users').doc(user.uid).get();

                if (userDoc.exists) {
                    // å¦‚æœä½¿ç”¨è€…è¨­å®šæª”å·²å­˜åœ¨ï¼Œç›´æ¥å°å‘å°æ‡‰é é¢
                    routeUser(userDoc.data().role);
                } else {
                    // å¦‚æœæ˜¯æ–°ç”¨æˆ¶ï¼Œå•Ÿå‹•é¦–æ¬¡ç™»å…¥çš„å¼•å°æµç¨‹
                    await startOnboarding(user);
                }
            } else {
                splashScreen.style.display = 'none';
                loginView.style.display = 'block';
                schoolSelectionView.style.display = 'none';
                teacherSelectionView.style.display = 'none';
            }
        });
        
        // ã€ã€ã€ major change: å…¨æ–°çš„ Onboarding æµç¨‹ ã€‘ã€‘ã€‘

        // æ­¥é©Ÿ 1: æ ¹æ“š Email ç¶²åŸŸå°‹æ‰¾å¯èƒ½çš„å­¸æ ¡
        async function startOnboarding(user) {
            try {
                const emailDomain = user.email.split('@')[1];

                const schoolsSnapshot = await db.collection('schools').where('domain', '==', emailDomain).get();
                
                if (schoolsSnapshot.empty) {
                    showLoginError(`æ‚¨çš„ Email ç¶²åŸŸ (${emailDomain}) æœªåœ¨æœ¬ç³»çµ±è¨»å†Šä»»ä½•å­¸æ ¡ã€‚è«‹è¯ç¹«è¶…ç´šç®¡ç†å“¡ã€‚`);
                    return;
                }

                const potentialSchools = schoolsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

                if (potentialSchools.length === 1) {
                    // å¦‚æœåªæœ‰ä¸€æ‰€å­¸æ ¡ç¬¦åˆï¼Œç›´æ¥é€²å…¥ä¸‹ä¸€æ­¥ï¼Œå„ªåŒ–é«”é©—
                    await handleSchoolSelection(user, potentialSchools[0].id);
                } else {
                    // å¦‚æœæœ‰å¤šæ‰€å­¸æ ¡ï¼Œè®“ä½¿ç”¨è€…é¸æ“‡
                    displaySchoolSelection(user, potentialSchools);
                }

            } catch (error) {
                showLoginError("é©—è­‰å­¸æ ¡èº«åˆ†æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š" + error.message);
            }
        }

        // æ­¥é©Ÿ 2: é¡¯ç¤ºå­¸æ ¡é¸æ“‡ç•«é¢
        function displaySchoolSelection(user, schools) {
            const schoolList = document.getElementById('school-selection-list');
            schoolList.innerHTML = '';
            schools.forEach(school => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${school.name}</strong>`;
                li.onclick = () => handleSchoolSelection(user, school.id);
                schoolList.appendChild(li);
            });
            
            splashScreen.style.display = 'none';
            loginView.style.display = 'none';
            schoolSelectionView.style.display = 'flex';
        }

        // æ­¥é©Ÿ 3: ç•¶ä½¿ç”¨è€…é¸æ“‡å­¸æ ¡å¾Œï¼Œåœ¨è©²æ ¡å…§å°‹æ‰¾ç¬¦åˆå§“åçš„æ•™å¸«
        async function handleSchoolSelection(user, schoolId) {
            try {
                splashScreen.style.display = 'flex';
                
                const googleName = user.displayName;
                const teachersSnapshot = await db.collection('schools').doc(schoolId).collection('teachers').where('name', '==', googleName).get();

                if (teachersSnapshot.empty) {
                    const schoolDoc = await db.collection('schools').doc(schoolId).get();
                    const schoolName = schoolDoc.exists ? schoolDoc.data().name : 'è©²å­¸æ ¡';
                    showLoginError(`åœ¨ã€Œ${schoolName}ã€çš„æ•™å¸«åå†Šä¸­æ‰¾ä¸åˆ°æ‚¨çš„å§“åã€Œ${googleName}ã€ã€‚è«‹è¯ç¹«æ‚¨çš„å­¸æ ¡ç®¡ç†è€…ï¼Œç¢ºèªåå†Šä¸Šçš„å§“åæ˜¯å¦èˆ‡æ‚¨çš„ Google å¸³æˆ¶åç¨±å®Œå…¨ä¸€è‡´ã€‚`);
                    return;
                }

                const matchingTeachers = teachersSnapshot.docs.map(doc => doc.data());

                if (matchingTeachers.length === 1) {
                    // å¦‚æœåªæœ‰ä¸€ä½ç¬¦åˆï¼Œç›´æ¥ç¶å®š
                    await createUserProfile(user, schoolId, matchingTeachers[0]);
                } else {
                    // å¦‚æœåŒæ ¡æœ‰å¤šä½åŒåæ•™å¸«ï¼Œè®“ä½¿ç”¨è€…åšæœ€çµ‚é¸æ“‡
                    const schoolDoc = await db.collection('schools').doc(schoolId).get();
                    const schoolName = schoolDoc.exists ? schoolDoc.data().name : '';
                    displayTeacherSelection(user, schoolId, schoolName, matchingTeachers);
                }

            } catch (error) {
                 showLoginError("æŸ¥æ‰¾æ•™å¸«è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š" + error.message);
            }
        }

        // æ­¥é©Ÿ 4: é¡¯ç¤ºåŒæ ¡åŒåæ•™å¸«çš„æœ€çµ‚é¸æ“‡ç•«é¢
        function displayTeacherSelection(user, schoolId, schoolName, teachers) {
            const teacherList = document.getElementById('teacher-selection-list');
            document.getElementById('teacher-selection-title').textContent = `åœ¨ã€Œ${schoolName}ã€ä¸­ï¼Œè«‹é¸æ“‡æ‚¨çš„èº«ä»½`;
            teacherList.innerHTML = '';
            teachers.forEach(teacher => {
                const li = document.createElement('li');
                // é¡¯ç¤ºè·ç¨±å’Œç§‘ç›®ä»¥ä¾›å€åˆ†
                li.innerHTML = `<strong>${teacher.name}</strong><span>${teacher.title || 'æ•™å¸«'} - ${teacher.subject || 'ç¶œåˆ'}</span>`;
                li.onclick = () => createUserProfile(user, schoolId, teacher);
                teacherList.appendChild(li);
            });

            splashScreen.style.display = 'none';
            loginView.style.display = 'none';
            schoolSelectionView.style.display = 'none';
            teacherSelectionView.style.display = 'flex';
        }

        // æ­¥é©Ÿ 5: æœ€çµ‚ç¶å®šï¼Œå»ºç«‹ä½¿ç”¨è€…è¨­å®šæª” (æ­¤å‡½æ•¸é‚è¼¯ä¸è®Šï¼Œæ˜¯æ­£ç¢ºçš„)
		async function createUserProfile(user, schoolId, teacherProfile) {
			try {
				splashScreen.style.display = 'flex';

				const schoolDoc = await db.collection('schools').doc(schoolId).get();
				if (!schoolDoc.exists) throw new Error("æ‰¾ä¸åˆ°å­¸æ ¡è³‡æ–™");
				const schoolData = schoolDoc.data();

				// çµ„åˆæ‰€æœ‰è³‡è¨Šï¼Œå»ºç«‹ä¸€ä»½å®Œæ•´çš„ user profile
				const newUserProfile = {
					role: 'teacher',
					email: user.email,
					displayName: teacherProfile.name, // ä½¿ç”¨åå†Šä¸Šçš„åå­—ä½œç‚ºå®˜æ–¹åå­—
					schoolId: schoolId,
					schoolCode: schoolData.schoolCode,
					...teacherProfile // è¤‡è£½æ‰€æœ‰è¡Œæ”¿è³‡æ–™ (title, subject, department...)
				};

				await db.collection('users').doc(user.uid).set(newUserProfile);
				routeUser('teacher');

			} catch (error) {
				showLoginError("å»ºç«‹ä½¿ç”¨è€…è¨­å®šæ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š" + error.message);
			}
		}

        // --- äº‹ä»¶ç›£è½å™¨èˆ‡è¼”åŠ©å‡½æ•¸ (å¤§éƒ¨åˆ†ç¶­æŒä¸è®Š) ---

        googleSignInBtn.addEventListener('click', async () => {
            errorMessage.textContent = '';
            splashScreen.style.display = 'flex';
            const provider = new firebase.auth.GoogleAuthProvider();
            try {
                await auth.signInWithPopup(provider);
            } catch (error) {
                splashScreen.style.display = 'none';
                errorMessage.textContent = 'Google ç™»å…¥å¤±æ•—: ' + error.message;
            }
        });

        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = loginEmailInput.value;
            const password = document.getElementById('login-password').value;
            errorMessage.textContent = '';
            splashScreen.style.display = 'flex';
            
            try {
                const persistence = document.getElementById('remember-me').checked ? firebase.auth.Auth.Persistence.LOCAL : firebase.auth.Auth.Persistence.SESSION;
                await auth.setPersistence(persistence);
                await auth.signInWithEmailAndPassword(email, password);
            } catch (error) {
                splashScreen.style.display = 'none';
                errorMessage.textContent = 'Email æˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹æª¢æŸ¥å¾Œå†è©¦ã€‚';
            }
        });

        showAdminLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            teacherLoginView.style.display = 'none';
            adminLoginView.style.display = 'block';
            errorMessage.textContent = '';
        });

        backToTeacherLoginLink.addEventListener('click', (e) => {
            e.preventDefault();
            adminLoginView.style.display = 'none';
            teacherLoginView.style.display = 'block';
            errorMessage.textContent = '';
        });

        document.querySelectorAll('.toggle-password').forEach(toggle => {
			toggle.addEventListener('click', () => {
				const targetId = toggle.dataset.target;
				const passwordInput = document.getElementById(targetId);
				if (passwordInput.type === 'password') {
					passwordInput.type = 'text';
					toggle.textContent = 'ğŸ™ˆ';
				} else {
					passwordInput.type = 'password';
					toggle.textContent = 'ğŸ‘ï¸';
				}
			});
		});

        function routeUser(role) {
            if (role === 'admin') {
                window.location.href = 'admin.html';
            } else if (role === 'school_admin') {
                window.location.href = 'school_admin.html';
            } else if (role === 'teacher') {
                window.location.href = 'teacher.html';
            } else {
                showLoginError(`æœªçŸ¥çš„ç”¨æˆ¶è§’è‰² (${role})ï¼Œç„¡æ³•ç™»å…¥ã€‚`);
            }
        }

        function showLoginError(msg) {
            splashScreen.style.display = 'none';
            loginView.style.display = 'block';
            schoolSelectionView.style.display = 'none';
            teacherSelectionView.style.display = 'none';
            errorMessage.textContent = msg;
            // ç™¼ç”ŸéŒ¯èª¤æ™‚ï¼Œå‹™å¿…ç™»å‡ºï¼Œé¿å…ä½¿ç”¨è€…å¡åœ¨é©—è­‰æµç¨‹ä¸­
            auth.signOut();
        }
    });
    </script>
</body>
</html>

