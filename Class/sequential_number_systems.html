<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>é€²ä½ç³»çµ±åŸç†ï¼šé€²ä½å‹•ç•«èˆ‡è¦å‰‡è©³è§£ç‰ˆ</title>
    <style>
        body { font-family: 'Microsoft JhengHei', sans-serif; text-align: center; background-color: #121212; color: #e0e0e0; overflow: hidden; margin: 0; }
        .container { position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        
        /* æ¨™é¡Œç³»çµ± */
        .title { font-size: 3em; margin-bottom: 10px; color: #bb86fc; opacity: 0; transform: translateY(-30px); transition: all 0.5s ease; text-shadow: 0 0 10px rgba(187,134,252,0.3); }
        .subtitle { font-size: 1.5em; color: #03dac6; opacity: 0; transform: translateY(30px); transition: all 0.5s ease; margin-bottom: 10px; height: 1.5em; }

        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            position: fixed; top: 20px; right: 20px;
            background: rgba(30, 30, 30, 0.9); backdrop-filter: blur(10px);
            padding: 15px 20px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column; align-items: center; gap: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); z-index: 2000;
        }
        .control-row { display: flex; gap: 10px; align-items: center; }
        .btn {
            background: transparent; border: 1px solid #fff; color: #fff; padding: 5px 10px;
            border-radius: 8px; cursor: pointer; font-size: 0.9em; transition: all 0.2s;
        }
        .btn:hover { background: #fff; color: #121212; }
        .btn.active { background: #03dac6; border-color: #03dac6; color: #000; font-weight: bold;}

        /* é¡¯ç¤ºå€å¡Š */
        .display-area {
            display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 20px;
            width: 95%; max-width: 1200px; opacity: 0; transition: opacity 0.5s;
            padding-top: 50px; padding-bottom: 50px;
        }

        /* Phase 1 & 2: è¨ˆæ•¸å™¨èˆ‡é€²ä½å‹•ç•«æ¨£å¼ */
        .counter-card {
            background: #1f1b24; border: 4px solid #333; border-radius: 20px;
            padding: 40px 50px; min-width: 350px; text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5); position: relative;
            display: flex; flex-direction: column; align-items: center;
        }
        .rule-tag {
            position: absolute; top: -25px; left: 50%; transform: translateX(-50%);
            background: #cf6679; color: white; padding: 8px 25px; border-radius: 15px;
            font-weight: bold; font-size: 1.4em; box-shadow: 0 5px 10px rgba(0,0,0,0.5); white-space: nowrap;
            z-index: 10; border: 2px solid #fff;
        }
        
        /* æ•¸ä½é¡¯ç¤ºå€ (Phase 2) */
        .digit-container {
            display: flex; justify-content: center; align-items: flex-end; gap: 15px; margin: 40px 0; height: 120px;
        }
        .digit-box {
            width: 80px; height: 100px; background: #333; border-radius: 10px;
            display: flex; justify-content: center; align-items: center;
            font-size: 4em; font-weight: bold; font-family: 'Courier New', monospace;
            color: #fff; border: 2px solid #555; position: relative;
            transition: all 0.2s;
        }
        .digit-box.changed { border-color: #03dac6; color: #03dac6; transform: scale(1.1); }
        .digit-box.reset { border-color: #cf6679; color: #cf6679; }
        
        /* é€²ä½é£›è¡Œç²’å­ */
        .carry-particle {
            position: absolute; top: 0; left: 0;
            color: #ff5252; font-weight: bold; font-size: 1.5em;
            pointer-events: none; opacity: 0; z-index: 100;
        }

        .process-info { font-size: 1.5em; color: #aaa; height: 40px; margin-bottom: 10px;}
        .plus-indicator { color: #03dac6; font-weight: bold; opacity: 0; font-size: 1.5em; position: absolute; bottom: -40px; right: 15px;}

        /* Phase 3: è¦å‰‡èˆ‡è¨ˆç®—æ¨£å¼ */
        .rule-box {
            background: #1e1e1e; padding: 40px; border-radius: 20px; border: 2px solid #03dac6;
            text-align: center; width: 90%;
        }
        .calc-container {
            display: flex; justify-content: center; align-items: flex-start; gap: 50px; /* é–“è·åŠ å¤§ */
            margin-top: 30px; width: 100%;
        }
        .digit-column {
            display: flex; flex-direction: column; align-items: center; gap: 20px;
            opacity: 0; transform: translateY(20px); transition: all 0.5s;
        }
        .d-row {
            padding: 10px; border-radius: 10px; min-width: 80px; text-align: center;
        }
        .d-digit {
            font-size: 4em; font-weight: bold; font-family: 'Courier New', monospace;
            background: #333; border: 2px solid #555; color: #fff;
        }
        .d-arrow { font-size: 2em; color: #666; height: 30px; line-height: 30px;}
        .d-formula {
            font-size: 1.6em; color: #aaa; border-bottom: 1px solid #555; padding-bottom: 5px; white-space: nowrap;
            font-family: 'Times New Roman', serif;
        }
        .d-val {
            font-size: 2em; color: #03dac6; font-weight: bold;
        }
        .total-sum-box {
            margin-top: 40px; font-size: 2.5em; border-top: 3px double #fff; padding-top: 20px; width: 80%;
            opacity: 0; transition: opacity 0.5s;
        }

        /* æ¬¡æ–¹é¡¯ç¤ºå„ªåŒ– */
        .math-base { font-family: 'Times New Roman', serif; font-size: 1.1em; }
        sup.math-exp {
            font-size: 0.6em; vertical-align: super; position: relative; top: -0.5em;
            color: #ffb74d; margin-right: 5px;
        }
        .pos-indicator { font-size: 0.8em; color: #ffb74d; margin-top: 5px; }

        /* Phase 4: æ¬¡æ–¹è¡¨ */
        .power-table { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; text-align: left; background: #1e1e1e; padding: 30px; border-radius: 15px; border: 1px solid #333; width: 100%; font-size: 1.1em;}
        .power-row { padding: 8px; border-bottom: 1px solid #333; }

        /* Phase 5: æ¸›æ³• */
        .subtraction-step { display: flex; justify-content: space-between; align-items: center; font-size: 1.6em; width: 100%; margin: 10px 0; opacity: 0; border-bottom: 1px dashed #333; padding-bottom: 5px;}

    </style>
</head>
<body>

    <div class="control-panel">
        <div class="control-row">
            <button class="btn" id="playPauseBtn" onclick="togglePause()" style="width: 100%;">â¸ æš«åœå‹•ç•«</button>
        </div>
        <div class="control-row">
            <span style="font-size: 0.8em; color: #aaa;">é€Ÿåº¦:</span>
            <button class="btn" onclick="setSpeed(0.5)">0.5x</button>
            <button class="btn active" onclick="setSpeed(1)">1x</button>
            <button class="btn" onclick="setSpeed(2)">2x</button>
            <button class="btn" onclick="setSpeed(5)">5x</button>
        </div>
    </div>

    <div class="container" id="mainContainer">
        <h1 class="title" id="mainTitle">é€²ä½ç³»çµ±å…¨è§£æ</h1>
        <p class="subtitle" id="subTitle">æœ€å¤§æ•¸å­— = é€²ä½åŸºæ•¸ - 1</p>
        
        <div id="contentArea" class="display-area">
            </div>
    </div>

    <script>
        // === æ ¸å¿ƒæ§åˆ¶é‚è¼¯ ===
        let isPaused = false;
        let timeScale = 1.0;

        function togglePause() {
            isPaused = !isPaused;
            const btn = document.getElementById('playPauseBtn');
            btn.innerText = isPaused ? "â–¶ æ’­æ”¾å‹•ç•«" : "â¸ æš«åœå‹•ç•«";
            btn.style.background = isPaused ? "#03dac6" : "transparent";
            btn.style.color = isPaused ? "#000" : "#fff";
        }

        function setSpeed(speed) {
            timeScale = speed;
            document.querySelectorAll('.control-panel .btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
        }

        function wait(ms) {
            return new Promise(resolve => {
                const checkInterval = 50;
                let elapsed = 0;
                const timer = setInterval(() => {
                    if (!isPaused) {
                        elapsed += checkInterval * timeScale;
                        if (elapsed >= ms) { clearInterval(timer); resolve(); }
                    }
                }, checkInterval);
            });
        }

        // === DOM æ“ä½œ ===
        const titleEl = document.getElementById('mainTitle');
        const subTitleEl = document.getElementById('subTitle');
        const contentArea = document.getElementById('contentArea');

        function updateHeader(t, s) {
            titleEl.style.opacity = 0;
            subTitleEl.style.opacity = 0;
            setTimeout(() => {
                titleEl.innerText = t;
                subTitleEl.innerText = s;
                titleEl.style.opacity = 1;
                subTitleEl.style.opacity = 1;
            }, 500);
        }

        function clearContent() {
            contentArea.style.opacity = 0;
            return new Promise(resolve => setTimeout(() => {
                contentArea.innerHTML = '';
                contentArea.style.opacity = 1;
                resolve();
            }, 500));
        }

        // === é€²ä½æ¼”ç¤ºè¼”åŠ©å‡½å¼ ===
        // å°‡æ•¸å­—æ‹†è§£ç‚ºé™£åˆ— (ä¾‹å¦‚ 10é€²ä½, 11 -> [1, 1])
        function getDigitArray(num, base) {
            if (num === 0) return [0];
            let arr = [];
            let temp = num;
            while (temp > 0) {
                arr.unshift(temp % base);
                temp = Math.floor(temp / base);
            }
            return arr;
        }

        function numToChar(val) {
            if (val < 10) return val;
            return String.fromCharCode(55 + val); // 10->A, 11->B...
        }

        // === å‹•ç•«æµç¨‹ ===
        async function startShow() {
            while(true) {
                
                // Phase 1: é€²ä½æ³•å‰‡
                updateHeader("1. é€²ä½åˆ¶çš„é»ƒé‡‘æ³•å‰‡", "åŸºæ•¸æ˜¯ Xï¼Œæœ€å¤§ç¬¦è™Ÿå°±æ˜¯ X-1");
                await clearContent();
                await wait(1000);

                const ruleDiv = document.createElement('div');
                ruleDiv.style.fontSize = "2.2em";
                ruleDiv.style.textAlign = "left";
                ruleDiv.style.lineHeight = "1.8em";
                ruleDiv.innerHTML = `
                    <div>10 é€²ä½ (0~9) â®• æœ€å¤§ç¬¦è™Ÿ <span style="color:#cf6679; font-weight:bold">9</span></div>
                    <div> 2 é€²ä½ (0~1) â®• æœ€å¤§ç¬¦è™Ÿ <span style="color:#cf6679; font-weight:bold">1</span></div>
                    <div> 5 é€²ä½ (0~4) â®• æœ€å¤§ç¬¦è™Ÿ <span style="color:#cf6679; font-weight:bold">4</span></div>
                    <div> 7 é€²ä½ (0~6) â®• æœ€å¤§ç¬¦è™Ÿ <span style="color:#cf6679; font-weight:bold">6</span></div>
                    <div>16 é€²ä½ (0~F) â®• æœ€å¤§ç¬¦è™Ÿ <span style="color:#cf6679; font-weight:bold">F (15)</span></div>
                `;
                contentArea.appendChild(ruleDiv);
                setTimeout(()=>contentArea.style.opacity = 1, 100);
                await wait(5000);


                // Phase 2: ä¾åºæ¼”ç¤º (å…·å‚™é€²ä½å‹•ç•«)
                updateHeader("2. ä¾åºåŠ  1ï¼Œè§€å¯Ÿé€²ä½", "è«‹æ³¨æ„é€²ä½å¾Œçš„æ•¸å­—è®€æ³•");
                await clearContent();

                const bases = [
                    { name: "10 é€²ä½ (Decimal)", base: 10, max: 9, countTo: 11, color: "#90caf9" },
                    { name: "2 é€²ä½ (Binary)", base: 2, max: 1, countTo: 4, color: "#cf6679" }, 
                    { name: "5 é€²ä½ (Quinary)", base: 5, max: 4, countTo: 6, color: "#fff176" }, 
                    { name: "7 é€²ä½ (Septenary)", base: 7, max: 6, countTo: 8, color: "#ffb74d" }, 
                    { name: "16 é€²ä½ (Hex)", base: 16, max: 15, countTo: 17, color: "#03dac6" } 
                ];

                for (let bInfo of bases) {
                    await clearContent();
                    let maxText = bInfo.base === 16 ? "F (15)" : bInfo.max;
                    let readTip = (bInfo.base === 10) ? "ç¿’æ…£è®€æ³•ï¼šåã€åä¸€" : `âš ï¸ æ³¨æ„ï¼šè«‹è®€ä½œã€Œ1 0ã€è€Œéã€Œåã€ï¼`;
                    updateHeader(bInfo.name, readTip);
                    
                    const card = document.createElement('div');
                    card.className = 'counter-card';
                    card.style.borderColor = bInfo.color;
                    
                    // å‹•æ…‹ç”¢ç”Ÿæ•¸ä½æ ¼å­çš„å®¹å™¨
                    card.innerHTML = `
                        <div class="rule-tag" style="background:${bInfo.color}; color:#121212">MAX = ${maxText}</div>
                        <div class="digit-container" id="digitBoxContainer">
                            <div class="digit-box" id="digit-0">0</div>
                        </div>
                        <div class="process-info" id="processInfo">æº–å‚™é–‹å§‹...</div>
                    `;
                    contentArea.appendChild(card);
                    await wait(1000);

                    const digitContainer = document.getElementById('digitBoxContainer');
                    const processInfo = document.getElementById('processInfo');

                    // æ¨¡æ“¬åŠ æ³•å™¨çš„ç‹€æ…‹é™£åˆ— (å¾å€‹ä½æ•¸é–‹å§‹ [å€‹ä½, åä½, ç™¾ä½...])
                    // åˆå§‹åŒ–ï¼šåªæœ‰å€‹ä½æ•¸ 0
                    let currentDigits = [0]; 

                    // æ›´æ–°ç•«é¢å‡½å¼ (éå‹•ç•«æ›´æ–°ï¼Œç”¨æ–¼åˆå§‹åŒ–æˆ–é‡ç¹ª)
                    function renderDigits() {
                        digitContainer.innerHTML = '';
                        // åè½‰é™£åˆ—ä¾†æ¸²æŸ“ (é«˜ä½åœ¨å·¦ï¼Œä½ä½åœ¨å³)
                        for(let i = currentDigits.length - 1; i >= 0; i--) {
                            let div = document.createElement('div');
                            div.className = 'digit-box';
                            div.id = `digit-${i}`;
                            div.innerText = numToChar(currentDigits[i]);
                            div.style.borderColor = bInfo.color;
                            digitContainer.appendChild(div);
                        }
                    }

                    // åŸ·è¡Œè¨ˆæ•¸å¾ªç’°
                    for(let k = 1; k <= bInfo.countTo; k++) {
                        processInfo.innerText = `+1`;
                        await wait(500);

                        // åŠ æ³•é‚è¼¯èˆ‡é€²ä½å‹•ç•«
                        let pos = 0;
                        let carry = true;
                        
                        // æ‰¾åˆ°å°æ‡‰çš„å€‹ä½æ•¸ DOM
                        let targetDigit = document.getElementById(`digit-${pos}`);
                        if (!targetDigit) {
                            // å¦‚æœé‚„æ²’æœ‰ DOM (ç†è«–ä¸Šéƒ½æœ‰)ï¼Œé‡ç¹ª
                            renderDigits();
                            targetDigit = document.getElementById(`digit-${pos}`);
                        }

                        // æ·»åŠ  +1 æŒ‡ç¤ºå™¨
                        let plusInd = document.createElement('div');
                        plusInd.className = 'plus-indicator';
                        plusInd.innerText = '+1';
                        targetDigit.appendChild(plusInd);
                        setTimeout(() => { plusInd.style.opacity = 1; plusInd.style.transform = 'translateY(0)'; }, 50);

                        await wait(800);

                        // åŸ·è¡Œé€£é–é€²ä½æª¢æŸ¥
                        while (carry) {
                            // ç¢ºä¿é™£åˆ—å¤ é•·
                            if (pos >= currentDigits.length) {
                                currentDigits.push(0);
                                // æ–°å¢é«˜ä½ DOM
                                let newDigit = document.createElement('div');
                                newDigit.className = 'digit-box';
                                newDigit.id = `digit-${pos}`;
                                newDigit.innerText = '0';
                                newDigit.style.borderColor = bInfo.color;
                                // æ’åœ¨æœ€å‰é¢ (è¦–è¦ºä¸Šçš„å·¦é‚Š)
                                digitContainer.prepend(newDigit);
                                await wait(100); // è®“æ–°å¢å‹•ç•«è·‘ä¸€ä¸‹
                            }

                            let currentVal = currentDigits[pos];
                            let dom = document.getElementById(`digit-${pos}`);

                            if (currentVal < bInfo.max) {
                                // ä¸é€²ä½ï¼Œç›´æ¥ +1
                                currentDigits[pos]++;
                                dom.innerText = numToChar(currentDigits[pos]);
                                dom.classList.add('changed');
                                setTimeout(() => dom.classList.remove('changed'), 300);
                                carry = false;
                            } else {
                                // é€²ä½ç™¼ç”Ÿï¼
                                processInfo.innerText = "ğŸ’¥ æ»¿äº†ï¼é€²ä½ï¼";
                                dom.classList.add('reset'); // è®Šè‰²æç¤ºæ­¸é›¶
                                await wait(400);
                                
                                // 1. æ­¸é›¶
                                currentDigits[pos] = 0;
                                dom.innerText = '0';
                                await wait(200);
                                dom.classList.remove('reset');

                                // 2. é€²ä½ç²’å­å‹•ç•«
                                let particle = document.createElement('div');
                                particle.className = 'carry-particle';
                                particle.innerText = '+1';
                                dom.appendChild(particle);
                                
                                // è¨ˆç®—ç§»å‹•è·é›¢ (å¾€å·¦é£›ä¸€å€‹ box å¯¬åº¦ + gap)
                                // ç°¡å–®åšæ³•ï¼šåªåšé€æ˜åº¦å’Œä½ç§»
                                particle.animate([
                                    { opacity: 1, transform: 'translate(0, 0)' },
                                    { opacity: 0, transform: 'translate(-100px, -20px)' } 
                                ], { duration: 600, easing: 'ease-out' });

                                await wait(500); // ç­‰å¾…ç²’å­é£›éå»
                                pos++; // æª¢æŸ¥ä¸‹ä¸€ä½
                            }
                        }
                        
                        processInfo.innerText = "";
                        // ç§»é™¤ +1 æŒ‡ç¤ºå™¨
                        if(plusInd && plusInd.parentNode) plusInd.remove();
                        await wait(1000);
                    }
                    await wait(2000);
                }


                // Phase 3: è¦å‰‡é  (é‡æ§‹)
                
                // 3.0 è¦å‰‡é é¢ (ç›´å¼å°é½Šç‰ˆ)
                updateHeader("3. è½‰å› 10 é€²ä½ï¼šé€šç”¨è¦å‰‡", "å°‡æ¯å€‹ä½æ•¸æ‹†é–‹ï¼Œåˆ†åˆ¥è¨ˆç®—");
                await clearContent();

                const ruleBox = document.createElement('div');
                ruleBox.className = 'rule-box';
                ruleBox.style.border = "none";
                contentArea.appendChild(ruleBox);

                // å»ºç«‹è¦å‰‡çš„å®¹å™¨ (5å€‹è®Šæ•¸)
                let ruleContainer = document.createElement('div');
                ruleContainer.className = 'calc-container';
                ruleBox.appendChild(ruleContainer);

                const vars = ['a', 'b', 'c', 'd', 'e'];
                const varColor = ['#cf6679', '#fff176', '#ffb74d', '#03dac6', '#90caf9'];

                for(let i=0; i<5; i++) {
                    let power = 4-i;
                    let col = document.createElement('div');
                    col.className = 'digit-column';
                    
                    col.innerHTML = `
                        <div class="d-row d-digit" style="border-color:${varColor[i]}">${vars[i]}</div>
                        <div class="pos-indicator">ç¬¬ ${power} ä½</div>
                        <div class="d-arrow">â¬‡</div>
                        <div class="d-formula" style="color:#fff; border:none;">
                            <span style="color:${varColor[i]}">${vars[i]}</span> Ã— N<sup>${power}</sup>
                        </div>
                    `;
                    ruleContainer.appendChild(col);
                    
                    setTimeout(() => {
                        col.style.opacity = 1;
                        col.style.transform = "translateY(0)";
                    }, i * 200);
                }
                setTimeout(()=>contentArea.style.opacity = 1, 100);
                await wait(6000);

                // 3.1 ç¯„ä¾‹æ¼”ç¤º (èˆ‡è¦å‰‡é ç‰ˆå‹ä¸€è‡´)
                const examples = [
                    { 
                        title: "ç¯„ä¾‹ 1ï¼š2 é€²ä½ (5ä½æ•¸)", numStr: "10110", base: 2, 
                        digits: [1, 0, 1, 1, 0], color: "#cf6679"
                    },
                    { 
                        title: "ç¯„ä¾‹ 2ï¼š5 é€²ä½ (3ä½æ•¸)", numStr: "123", base: 5, 
                        digits: [1, 2, 3], color: "#fff176"
                    },
                    { 
                        title: "ç¯„ä¾‹ 3ï¼š16 é€²ä½ (2ä½æ•¸)", numStr: "2F", base: 16, 
                        digits: ["2", "F"], realValues: [2, 15], color: "#03dac6"
                    }
                ];

                for (let ex of examples) {
                    updateHeader(ex.title, `åŸºåº•ï¼š${ex.base} é€²ä½`);
                    await clearContent();
                    
                    let container = document.createElement('div');
                    container.className = 'calc-container';
                    contentArea.appendChild(container);
                    
                    let len = ex.digits.length;
                    let calculatedValues = [];

                    for (let i = 0; i < len; i++) {
                        let dSym = ex.digits[i]; 
                        let dVal = ex.realValues ? ex.realValues[i] : dSym; 
                        let power = len - 1 - i; 
                        let colVal = dVal * Math.pow(ex.base, power);
                        calculatedValues.push(colVal);

                        let col = document.createElement('div');
                        col.className = 'digit-column';
                        
                        let posIndicator = `<div class="pos-indicator">ç¬¬ ${power} ä½</div>`;
                        
                        let formulaHtml = `
                            <span style="color:${ex.color}">${dVal}</span> Ã— 
                            <span class="math-base">${ex.base}</span><sup class="math-exp">${power}</sup>
                        `;
                        
                        col.innerHTML = `
                            <div class="d-row d-digit" style="border-color:${ex.color}">${dSym}</div>
                            ${posIndicator}
                            <div class="d-arrow">â¬‡</div>
                            <div class="d-row d-formula">${formulaHtml}</div>
                            <div class="d-arrow">â¬‡</div>
                            <div class="d-row d-val">${colVal}</div>
                        `;
                        container.appendChild(col);
                        
                        setTimeout(() => {
                            col.style.opacity = 1;
                            col.style.transform = "translateY(0)";
                        }, i * 300);
                    }
                    
                    await wait(1000 + len * 300);
                    
                    let totalSum = calculatedValues.reduce((a, b) => a + b, 0);
                    let sumExp = calculatedValues.join(" + ");
                    
                    let sumBox = document.createElement('div');
                    sumBox.className = 'total-sum-box';
                    sumBox.innerHTML = `
                        <div style="font-size:0.5em; color:#aaa; margin-bottom:10px;">å°‡ä¸‹æ–¹æ•¸å€¼åŠ ç¸½ï¼š</div>
                        ${sumExp} = <span style="color:${ex.color}; font-weight:bold">${totalSum}</span>
                    `;
                    contentArea.appendChild(sumBox);
                    
                    setTimeout(() => sumBox.style.opacity = 1, 100);
                    await wait(5000);
                }


                // Phase 4: æ¬¡æ–¹è¡¨
                updateHeader("4. å¿…å‚™å¸¸è­˜ï¼š2 çš„æ¬¡æ–¹", "10é€²ä½è½‰2é€²ä½çš„å¥½å¹«æ‰‹");
                await clearContent();

                const powerTable = document.createElement('div');
                powerTable.className = 'power-table';
                
                const powers = [
                    { p: 0, v: 1 }, { p: 1, v: 2 }, { p: 2, v: 4 }, { p: 3, v: 8 },
                    { p: 4, v: 16 }, { p: 5, v: 32 }, { p: 6, v: 64 }, { p: 7, v: 128 },
                    { p: 8, v: 256 }, { p: 9, v: 512 }, { p: 10, v: "1024 (1K)" }
                ];
                
                let leftDiv = document.createElement('div');
                powers.forEach(p => {
                    leftDiv.innerHTML += `<div class="power-row">2<sup class="math-exp" style="color:#fff">${p.p}</sup> = ${p.v}</div>`;
                });
                
                let rightDiv = document.createElement('div');
                rightDiv.innerHTML = `
                    <div class="power-row" style="margin-top:20px; color:#03dac6">2<sup class="math-exp">10</sup> â‰ˆ 1K (åƒ)</div>
                    <div class="power-row" style="margin-top:20px; color:#03dac6">2<sup class="math-exp">20</sup> â‰ˆ 1M (ç™¾è¬)</div>
                    <div class="power-row" style="margin-top:20px; color:#03dac6">2<sup class="math-exp">30</sup> â‰ˆ 1G (åå„„)</div>
                    <div class="power-row" style="margin-top:20px; color:#03dac6">2<sup class="math-exp">40</sup> â‰ˆ 1T (å…†)</div>
                `;
                
                powerTable.appendChild(leftDiv);
                powerTable.appendChild(rightDiv);
                contentArea.appendChild(powerTable);
                await wait(5000);


                // Phase 5: æ¸›æ³•è½‰æ›
                updateHeader("5. 10é€²ä½è½‰2é€²ä½ (æ¸›æ³•æ³•)", "å¾æœ€å¤§æ¬¡æ–¹é–‹å§‹æ¸›");
                await clearContent();
                
                let targetNum = 85;
                let steps = [
                    { pow: 6, val: 64, bit: 1, rem: 21 },
                    { pow: 5, val: 32, bit: 0, rem: 21 },
                    { pow: 4, val: 16, bit: 1, rem: 5 },
                    { pow: 3, val: 8,  bit: 0, rem: 5 },
                    { pow: 2, val: 4,  bit: 1, rem: 1 },
                    { pow: 1, val: 2,  bit: 0, rem: 1 },
                    { pow: 0, val: 1,  bit: 1, rem: 0 }
                ];

                let calcDiv = document.createElement('div');
                calcDiv.className = 'rule-box';
                calcDiv.innerHTML = `<div style="font-size:2em; margin-bottom:20px;">ç›®æ¨™ï¼š<span style="color:#fff176">${targetNum}</span></div>`;
                
                contentArea.appendChild(calcDiv);
                
                let resultStr = "";
                for(let s of steps) {
                    let row = document.createElement('div');
                    row.className = 'subtraction-step';
                    
                    let bitColor = s.bit ? "#03dac6" : "#555";
                    let logicText = s.bit ? 
                        `${targetNum} - ${s.val} = <span style="color:#fff176">${s.rem}</span>` : 
                        `${targetNum} ä¸å¤ æ¸› ${s.val}`;
                    
                    row.innerHTML = `
                        <span style="font-size:0.8em; color:#aaa">2<sup class="math-exp" style="color:#aaa">${s.pow}</sup> (${s.val})</span>
                        <span>${logicText}</span>
                        <span style="font-size:1.5em; color:${bitColor}; font-weight:bold">${s.bit}</span>
                    `;
                    calcDiv.appendChild(row);
                    resultStr += s.bit;
                    if(s.bit) targetNum = s.rem; 
                    
                    setTimeout(()=> row.style.opacity = 1, 100);
                    await wait(1200);
                }
                
                let finalDiv = document.createElement('div');
                finalDiv.innerHTML = `çµæœï¼š(${resultStr})<sub>2</sub>`;
                finalDiv.style.fontSize = "2.5em";
                finalDiv.style.marginTop = "20px";
                finalDiv.style.borderTop = "1px solid #fff";
                calcDiv.appendChild(finalDiv);

                await wait(5000);
            }
        }

        startShow();

    </script>
</body>
</html>
